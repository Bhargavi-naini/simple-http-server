#!/bin/bash

set -eo pipefail
mv /tmp/src/* /opt/app-root/
mkdir -p /tmp/.s2i
mv /tmp/src/builder/ccp.yml /tmp/.s2i/ccp.yml
mv /tmp/src/builder/passwd.template /tmp/.s2i/passwd.template
mv /tmp/src/builder /opt/app-root/builder
mv /tmp/src/*.sh /opt/app-root/bin

# Make sure the S2I source directory is empty as we will use the image

# produced to run further S2I builds.

rm -rf /tmp/src

# Fixup permissions on directories and files.

fix-permissions /opt/app-root
